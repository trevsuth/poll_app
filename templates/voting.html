<!DOCTYPE html>
<html>
<head>
    <title>Voting Page</title>
</head>
<body>
    <h1>Voting Page</h1>
    <input type="text" id="pollId" placeholder="Enter Poll ID" required>
    <button onclick="fetchPoll()">Load Poll</button>
    <div id="pollQuestion"></div>
    <form id="voteForm">
        <!-- Voting options will be appended here -->
    </form>

    <script>
        function fetchPoll() {
            const pollId = document.getElementById('pollId').value;
            fetch(`/poll/${pollId}`) // Adjust this URL based on your actual API endpoint
                .then(response => response.json())
                .then(poll => {
                    displayPoll(poll);
                });
        }

        function displayPoll(poll) {
            document.getElementById('pollQuestion').textContent = poll.question;
            const form = document.getElementById('voteForm');
            form.innerHTML = ''; // Clear previous options
            poll.answers.forEach((answer, index) => {
                let radio = document.createElement('input');
                radio.type = 'radio';
                radio.name = 'answer';
                radio.value = answer;
                radio.id = 'answer' + index;

                let label = document.createElement('label');
                label.htmlFor = 'answer' + index;
                label.textContent = answer;

                form.appendChild(radio);
                form.appendChild(label);
                form.appendChild(document.createElement('br'));
            });

            let button = document.createElement('button');
            button.type = 'button';
            button.textContent = 'Vote';
            button.onclick = submitVote;
            form.appendChild(button);
        }

        function submitVote() {
            const selectedOption = document.querySelector('input[name="answer"]:checked').value;
            const pollId = document.getElementById('pollId').value;
            fetch(`/vote`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ pollId, answer: selectedOption })
            })
            .then(response => response.text())
            .then(result => {
                alert('Vote recorded: ' + result);
            });
        }
    </script>
</body>
</html>
